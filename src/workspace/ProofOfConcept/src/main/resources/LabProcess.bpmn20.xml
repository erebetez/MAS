<definitions xmlns:activiti="http://activiti.org/bpmn"
    id="definitions"
    targetNamespace="http://activiti.org/bpmn20"
    xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" >

    <process
        id="laborProcess"
        name="test_LaborProcess001" >

        <startEvent id="theStart" >

            <extensionElements>

                <activiti:formProperty
                    id="worklist"
                    name="Worklist"
                    required="true"
                    type="string" />
            </extensionElements>
        </startEvent>

        <sequenceFlow
            id="flow1"
            sourceRef="theStart"
            targetRef="scripttask_getdata" />

        <scriptTask
            id="scripttask_getdata"
            name="Getting Basic Data"
            scriptFormat="groovy" >

            <script>
                def varDilution = 3;
                
                execution.setVariable("varDilution", varDilution);
                
				out:println "Got Values " + varDilution;
            </script>
        </scriptTask>

        <sequenceFlow
            id="flow2"
            sourceRef="scripttask_getdata"
            targetRef="servicetask_getdataFromSDMS" />

		<serviceTask id="servicetask_getdataFromSDMS"
		    activiti:class="ch.erebetez.mas.SdmsAdapter">
		</serviceTask>

        <sequenceFlow
            id="flow3"
            sourceRef="servicetask_getdataFromSDMS"
            targetRef="scripttask_calculate" />
        
        <scriptTask
            id="scripttask_calculate"
            name="Calculating"
            scriptFormat="groovy" >

            <script>
                def varFormula = varDilution + " * " + varB;
                def varResult = varDilution * varB;
                
                execution.setVariable("varFormula", varFormula);
                execution.setVariable("varResult", varResult);
                
				out:println "calculating...";
            </script>
        </scriptTask>

        <sequenceFlow
            id="flow4"
            name="Send to App"
            sourceRef="scripttask_calculate"
            targetRef="scripttask_print" />

        <scriptTask
            id="scripttask_print"
            name="Validate Worklist"
            scriptFormat="groovy" >

            <script>
				out:println "Worklist entered " + worklist;
				out:println "Formula " + varFormula;
				
				out:println "Result " + varResult;
            </script>
        </scriptTask>

        <sequenceFlow
            id="flow5"
            sourceRef="scripttask_print"
            targetRef="theEnd" />

        <endEvent id="theEnd" />
    </process>

</definitions>